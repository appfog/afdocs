<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>AppFog &mdash; Documentation Add-on Partnership</title> 

		<link rel="stylesheet" href="http://appfog.com/css/style.css">
		<link href="/css/prettify.css" type="text/css" rel="stylesheet" />
		<link href="/css/table.css" rel="stylesheet">
		<link href="/css/docs.css" rel="stylesheet">
		<!-- typekit -->
		<script type="text/javascript" src="http://use.typekit.com/abw3xjt.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
				
		<!-- css -->

		<!-- modernizr -->
		<script src="http://appfog.com/js/libs/modernizr-2.5.3.min.js"></script>

		<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
		<script type="text/javascript" src="/js/bootstrap.js"></script>

		<!--  -->
		<link rel="icon" type="image/png" href="http://appfog.com/favicon.ico" />
		
		<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-16856502-8']);
      _gaq.push(['_setDomainName', '.appfog.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
		
	</head>
	<body id="blog" onload="prettyPrint()">
	<div id="header">
		<div class="container">
			<a href="http://appfog.com/" id="app_fog"><img src="http://appfog.com/img/app-fog.png" width="189" height="47" alt="App Fog"></a>
			<ul id="main_nav">
				<li id="nproducts">
					<a href="#" title="Products" class="parent"><span>Products</span></a>
					<ul>
						<li><a href="http://appfog.com/products/appfog">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog">PHP Fog</a></li>
					</ul>
				</li>
				<li id="npricing">
					<a href="#" title="Pricing" class="parent"><span>Pricing</span></a>
					<ul>
						<li><a href="https://console.appfog.com/pricing">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog/pricing/">PhpFog</a></li>
					</ul>
				</li>
				<li id="nshowcase"><a href="http://appfog.com/showcase/" title="Showcase">Showcase</a></li>
				<li id="nabout"><a href="http://appfog.com/about/" title="About">About</a></li>
				<li id="nsupport"><a href="http://appfog.com/support/" title="Support">Support</a></li>
				<li id="nblog"><a href="http://blog.appfog.com/" title="Blog">Blog</a></li>

				<li id="nlogin">
						  <a href="#" title="Log In" class="btn gray">Log In <i class="icon-chevron-down"></i></a>
						  <form id="log_in_form" class="dropdown">
							<div class="container">
							  <!-- <div class="half">
								<div class="radio_btn" id="log_in_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_php_fog" checked>
								  </span>
								  <label for="log_in_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="log_in_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_appfog">
								  </span>
								  <label for="log_in_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
							<!-- <hr> -->

							<!-- <div class="container appfog">
							  <input type="email" name="email" value="" id="appfog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="appfog_log_in_password" placeholder="Password" class="text">
							</div>
							
							<div class="container php_fog">
							  <input type="email" name="email" value="" id="php_fog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="php_fog_log_in_password" placeholder="Password" class="text">
							</div> -->
										

										
							<!-- <div class="container">  
							  <div class="half">
								<div class="checkbox">
								  <span class="active">
									<input type="checkbox" name="remember_me" value="" id="log_in_remember_me" checked>
								  </span>
								</div>
								<label for="log_in_remember_me" class="remember_me">Remember Me</label>
							  </div>

							  <div class="half forgot_password">
								<a href="#">Forgot Password?</a>
							  </div>
							</div> -->
										<a href="https://phpfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to PHP Fog</a>
										<hr>
										<a href="https://console.appfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to AppFog</a>
									</form>
								</li>
								<li id="nsignup">
									<a href="#" title="Sign Up" class="btn bright_green">Sign Up <i class="icon-chevron-down"></i></a>
									<form id="sign_up_form" class="dropdown">
							<!-- <div class="container">
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_php_fog" checked>
								  </span>
								  <label for="sign_up_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_appfog">
								  </span>
								  <label for="sign_up_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
										<!-- <hr>
													
													<div class="container php_fog">
													  <input type="email" name="email" value="" id="sign_up_php_fog_email" placeholder="Email" class="text">
													  <input type="password" name="password" value="" id="sign_up_password" placeholder="Password" class="text">
													  <input type="password" name="password_confirmation" value="" id="sign_up_password_confirmation" placeholder="Password Confirmation" class="text">
													</div>
													
													<div class="container appfog">
													  <input type="email" name="email" value="" id="sign_up_appfog_email" placeholder="Email" class="text">
													</div> -->
										
										<a href="https://phpfog.com/signup" class="btn bright_green submit" style="font-size: 13px;">Register for PHP Fog</a>
										<hr>
										<a href="http://appfog.com/signup.php" class="btn bright_green submit" style="font-size: 13px;">Register for AppFog</a>
									</form>
								</li>

			</ul>
		</div> 
	</div>
	<div id="main_content">
		<div class='container'>

			
			<div id="top_bar" class="row gray_blue margin_bottom">
				<div class="span12">
					<a href="/"><h1 class="title">AppFog Docs</h1></a>
					<ul id="docs_nav">
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="/add-ons">Add-ons</a></li>
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="#">Add-on Partnership</a></li>
					</ul>
					<ul id="secondary_nav">
						<li><a href="http://docs.phpfog.com">PHP Fog Docs</a></li>
					</ul>
				</div>

			</div>
			
					


			<div id="content" class="row white">
				<div class="span8 main_content">
					<div class="row entries">
	<div class="span8">
		<div class="row">
			<div class="span8">
				<h1>Add-on Partnership</h1>
				<p>AppFog provides your app with extra functionality by partnering with various third-party services. You can add everything from logs to databases to powerful metrics to your app with a single click . </p>

<h1 id="how-add-ons-work">How Add-ons Work</h1>

<p>Our add-on partners can create provisioning services that are compatible with AppFog. </p>

<ul>
  <li><a href="#provision">Provisioning Workflow</a></li>
  <li><a href="#callback">API Callback Spec</a></li>
  <li><a href="#api">API Spec</a></li>
  <li><a href="#authentication">Authentication</a></li>
  <li><a href="#manifest">Manifest Format</a></li>
  <li><a href="#sso">Single Sign-on</a></li>
</ul>

<h1 id="provision">Provisioning Workflow</h1>

<ol>
  <li>The user installs the add-on from the AppFog app console. This sends a request to the add-on partner to provision the service.</li>
  <li>AppFog makes a <code>POST</code> request to https://partner.com/appfog/resources. It passes in the <code>customer_id</code> (email address), plan, and the <code>callback_url</code>. </li>
  <li>The partner returns the local ID of the newly created resource. If it’s able to provision the resource synchronously, the config parameter can be set. It may not be possible to provision the resource synchronously, so the config can be empty.</li>
  <li>If the config is empty, the user sees a message stating that the resource is waiting to be provisioned.</li>
  <li>Once the resource is provisioned, the partner makes a call to the callback URL, as specified in the initial provisioning call, and passes the new config parameters to be set.</li>
  <li>Once the config parameters are set, they are set as environment variables in the user’s app and instructions are displayed to the user on how to perform the integration.</li>
</ol>

<p><img class="screenshot" src="/img/screenshots/Slide2.jpeg" alt="Provisioning Workflow" /></p>

<h1 id="callback">API Callback Spec</h1>

<p>This is a method implemented by the AppFog services. It is used to update the configuration values for a given resource as provided by the add-on partner. The configuration parameters can be specified by the partner when the provisioning call is made by AppFog; however, if the call takes a while to process the partner can use this method to update those parameters later.</p>

<p>PUT to path as defined in <code>callback_url</code> on provisioning call.</p>

<p>Request Body:</p>

<pre class="prettyprint"><code>{
    "config":{"VAR_XYZ":"http://partner.com/5678ADFD"} 
}
</code></pre>

<p>Response:</p>

<pre class="prettyprint"><code>200 OK
</code></pre>

<h1 id="api">API Spec</h1>

<h3 id="example-provisioning-request">Example Provisioning Request</h3>

<p>Request: <code>POST /phpfog/resources</code></p>

<p>Request Body:</p>

<pre class="prettyprint"><code>{
    "customer_id":"user@email.com",
    "plan":"free",
    "callback_url":"https://path_to_resource",
    "options":{} 
}
</code></pre>

<p>Response Body:</p>

<pre class="prettyprint"><code>{
    "id":789,
    "config":{"ADDONNAME_VAR1":"some configuration value"},
    "message":"" 
}
</code></pre>

<h3 id="request-fields">Request Fields</h3>

<ul>
  <li><code>customer_id</code> - The identification of the user in the AppFog system (i.e. email address).</li>
  <li><code>plan</code> - The plan being provisioned. This will be “free” for the moment; however, in the future this can be higher-tier plans once they’re supported.</li>
  <li><code>callback_url</code> - This is the address of the resource in AppFog’s system. The provider can use this to update the configuration for this resource (e.g. during provisioning).</li>
  <li><code>options</code> - This contains additional options for the specific service. It’s a placeholder for now and AppFog will not send these requests yet.</li>
</ul>

<h3 id="response-fields">Response Fields</h3>

<ul>
  <li><code>id</code> - This is the ID of the resource in the provider’s system. </li>
  <li><code>config</code> - The required key/value pairs of parameters required to provision the service. The manifest specifies what keys are allowed. Configuration paramters are required, but the particular configuration parameters up to the provider. They can also be updated later using the <code>callback_url</code> to update the config.</li>
  <li><code>message</code> - This is a message to the system. It’s ignored for now.</li>
</ul>

<h3 id="example-deprovisioning-request">Example Deprovisioning Request</h3>

<p>Request: <code>DELETE /phpfog/resources/:id</code></p>

<p>Request Body: none</p>

<p>Response: </p>

<pre class="prettyprint"><code>200 OK
</code></pre>

<h3 id="request-fields-1">Request Fields</h3>

<p>This is a DELETE request to the particular <code>URL</code> and doesn’t contain a body.</p>

<h3 id="response-fields-1">Response Fields</h3>

<p>Only an HTTP response status is required.</p>

<h1 id="authentication">Authentication</h1>

<p>All calls to both the provisioning API on the partners service as well as the AppFog callback service must be authenticated using <code>HTTP Basic Auth</code>.</p>

<p>All requests must be completed over <code>HTTPS</code>. </p>

<p>The manifest file specifies the username and password to be used for all of these calls. The “<code>id</code>” in the manifest is the username, the “<code>api_password</code>” is the password.</p>

<h1 id="manifest">Manifest Format</h1>

<p>The manifest file is a <code>JSON</code> document that defines the information necessary for AppFog to make provisioning calls to the provider.</p>

<p>Add-on partners should provide the manifest file out-of-band by emailing it to the AppFog team to incorporate into the system.</p>

<h3 id="example-manifest">Example Manifest</h3>

<p><code>example-manifest.json</code></p>

<pre class="prettyprint linenums"><code>{
    "id":"provider",
    "name":"Provider Inc",
    "plans":[
        {"id":"free"}
        ],    
    "api": {
        "config_vars":["PROVIDER_VAR_XYZ"],
        "production":"https://provider.com/",
        "test":"https://provider-qa.com/",
        "path":"PathToResource",
        "username":"SomeUsername",
        "password":"ChangeYourPassword",
        "sso_salt":"xPedFGIIJIei30D"       
    } 
}
</code></pre>

<h3 id="fields">Fields</h3>

<ul>
  <li><code>id</code> - The add-on id. All lowercase, no spaces or punctuation. This is used in conjunction with the password to authenticate provisioning calls.</li>
  <li><code>name</code> - The friendly name to appear in the add-on tab of the app console in AppFog.</li>
  <li><code>api/config_vars</code> - A list of variables to be returned on provisioning calls. The variable names must be prefixed with the add-on id and an underscore. Example: “<code>PROVIDER_</code>”</li>
  <li><code>api/production</code> - The root <code>URL</code> of the provisioning service of provider.</li>
  <li><code>api/test</code> - Same <code>URL</code> as production, but for testing in a QA environment.</li>
  <li><code>api/path</code> - (Optional) Overrides the default path “<code>appfog/resources</code>”.</li>
  <li><code>api/username</code> - (Optional) The username used by AppFog to authenticate itself with the partner service via <code>HTTP Basic Auth</code>. The “<code>id</code>” is used if the username is not specified.</li>
  <li><code>api/password</code> - The password used by AppFog to authenticate itself with the partner service via <code>HTTP Basic Auth</code>.</li>
  <li><code>api/sso_salt</code> - Shared secret used in single sign-on between AppFog and the provider.</li>
  <li><code>plans/id</code> - The name of the “free” plan that will be offered to AppFog users and used for testing and integration purposes.</li>
</ul>

<h1 id="sso">Single Sign-on</h1>

<p>Once a resource is fully provisioned, a “Manage” button will appear in the AppFog app console for the given add-on. This button will redirect the user to the management page of the particular resource on the partner’s website.</p>

<p>After the user clicks the button, they will be redirected to the following generated <code>URL</code>:</p>

<pre class="prettyprint"><code>https://partner.com/appfog/resources/:id?token=:token&amp;timestamp=:timestamp
</code></pre>

<p>The <code>:id</code> is the <code>id</code> of the resource which was defined in the response to the provisioning call for creating this resource.</p>

<p>The token is defined as a combination of the <code>id</code>, <code>salt</code>, and <code>timestamp</code>. </p>

<p>The salt is the “<code>sso_salt</code>” variable as defined in the manifest.</p>

<p>The timestamp is the current UNIX timestamp.</p>

<pre class="prettyprint"><code>token = sha1(id + ':' + salt + ':' + timestamp)
</code></pre>

<p>After the partner validates the salt (shared secret) and the timestamp (we recommend 30 seconds), they can be allowed to manage the resource as defined by the <code>id</code>.</p>


			</div>
		</div>
	</div>
</div>

				</div>

				<div class="span3 sidebar padding accordion" id="accordion2">
					<!--
					<div class="row border-bottom">
						<div class="span3">
							<form id="search-form" action="/search">
								<input type="search" placeholder="Search" id="search" name="q" size="30" />
								<input class="btn gray_blue search" type="submit" value="Go" />
							</form>
						</div>
					</div>-->
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne"><h6><i class="accordion-icon icon-chevron-right"></i> Getting Started</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseOne" style="height: 0;">
						
							<div class="accordion-inner">
								
								<li><a href="/getting-started/jumpstarts" >Jumpstarts</a></li>
								
								<li><a href="/getting-started/af-cli" >AF Command Line Tool</a></li>
								
							</div>
						</ul>
					</div>
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
						<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo"><h6><i class="accordion-icon icon-chevron-right"></i> Frameworks</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseTwo" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/frameworks/node" >Node</a></li>
							
							<li><a href="/frameworks/php" >PHP</a></li>
							
							<li><a href="/frameworks/python" >Python</a></li>
							
							<li><a href="/frameworks/ruby" >Ruby</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree"><h6><i class="accordion-icon icon-chevron-right"></i> Services</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseThree" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/services/overview" >Overview</a></li>
							
							<li><a href="/services/tunneling" >Tunneling</a></li>
							
							<li><a href="/services/mysql" >MySQL</a></li>
							
							<li><a href="/services/mongodb" >MongoDB</a></li>
							
							<li><a href="/services/postgresql" >PostgreSQL</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseFour"><h6><i class="accordion-icon icon-chevron-down"></i> Add-ons</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse in" id="collapseFour" style="height: auto;">
						
							<div class="accordion-inner">
							
							<li><a href="/add-ons/searchify" >Searchify</a></li>
							
							<li><a href="/add-ons/mongolab" >MongoLab</a></li>
							
							<li><a href="/add-ons/mongohq" >MongoHQ</a></li>
							
							<li><a href="/add-ons/mailgun" >Mailgun</a></li>
							
							<li><a href="/add-ons/blitz" >Blitz</a></li>
							
							<li><a href="/add-ons/ironworker" >IronWorker</a></li>
							
							<li><a href="/add-ons/ironmq" >IronMQ</a></li>
							
							<li><a href="/add-ons/cloudmailin" >CloudMailin</a></li>
							
							<li><a href="/add-ons/cleardb" >ClearDB</a></li>
							
							<li><a href="/add-ons/memcachier" >MemCachier</a></li>
							
							<li><a href="/add-ons/partners" class="on">Add-on Partnership</a></li>
							
							</div>
						</ul>
					</div>

						<div class="row border-bottom"><div class="span3"><a href="/faq" ><h6>FAQ</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="http://console.appfog.com/pricing"><h6>Pricing</h6></a></div></div>
						<div class="row border-bottom"><div class="span3"><a href="/billing" ><h6>BILLING</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/troubleshooting" ><h6>Troubleshooting</h6></div></a></div>
						<!--<div class="row border-bottom"><div class="span3"><a href="/architecture" ><h6>Architecture</h6></div></a></div>-->
						<div class="row border-bottom"><div class="span3"><a href="/roadmap" ><h6>Feature Roadmap</h6></div></a></div>

					</div>
				</div>
			</div><!-- content -->
		</div><!-- container -->
	</div><!-- main_content -->

	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="span1">
					<img src="http://appfog.com/img/bydevfordev_95.png" width="95" height="79" alt="By Developers For Developers" id="badge">
				</div>
				<div class="span3">
					<h4>About AppFog</h4>
					<p>Easily build and deploy fast, scalable, and reliable applications to the cloud in seconds. Yeah, it’s that easy.</p>					
				</div>
				<div class="span2">
					<h4>Info</h4>
					<ul>
						<li><a href="http://appfog.com/support/">Support</a></li>
						<li><a href="https://appfog.com/about/">About</a></li>
						<li><a href="http://dev.appfog.com/">Documentation</a></li>
					</ul>
				</div>
				<div class="span2 offsettop">
					<ul>
						<li>Phone: 1.888.974.7364</li>
						<li>&copy; <script>document.write(new Date().getFullYear());</script> AppFog.</li>
						<li>All Rights Reserved.</li>
					</ul>
				</div>
				<div class="span4">
					<h4>Social</h4>
					<ul id="social">
						<li id="facebook"><a href="http://www.facebook.com/pages/AppFog/159333004147490">Facebook</a></li>
						<li id="twitter"><a href="https://twitter.com/#!/appfog">Twitter</a></li>
						<li id="linkedin"><a href="http://www.linkedin.com/company/appfog">LinkedIn</a></li>
					</ul>
				</div>
			</div>
		</div> <!-- / .container -->
	</div>
	
	
<!-- scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://appfog.com/js/libs/jquery-1.7.1.min.js"><\/script>')</script>
<script src="http://appfog.com/js/plugins.js"></script>
<script src="http://appfog.com/js/script.js"></script>
<script type="text/javascript" src="/js/docs.js"></script>

</body>
</html>
