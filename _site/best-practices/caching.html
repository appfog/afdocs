<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>PHP Fog &mdash; Documentation Caching</title> 

		<link rel="stylesheet" href="http://appfog.com/css/style.css">
		<link href="/css/prettify.css" type="text/css" rel="stylesheet" />
		<link href="/css/phpfogdocs.css" rel="stylesheet">
		<!-- typekit -->
		<script type="text/javascript" src="http://use.typekit.com/abw3xjt.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
				
		<!-- css -->

		<!-- modernizr -->
		<script src="http://appfog.com/js/libs/modernizr-2.5.3.min.js"></script>

		<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
		<script type="text/javascript" src="/js/bootstrap.js"></script>

		
		<link rel="icon" type="image/png" href="https://phpfog.com/favicon.ico" />
	</head>
	<body id="blog" onload="prettyPrint()">
	<div id="header">
		<div class="container">
			<a href="http://appfog.com/" id="app_fog"><img src="http://appfog.com/img/app-fog.png" width="189" height="47" alt="App Fog"></a>
			<ul id="main_nav">
				<li id="nproducts">
					<a href="#" title="Products" class="parent"><span>Products</span></a>
					<ul>
						<li><a href="http://appfog.com/products/appfog">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog">PHP Fog</a></li>
					</ul>
				</li>
				<li id="npricing">
					<a href="#" title="Pricing" class="parent"><span>Pricing</span></a>
					<ul>
						<li><a href="https://console.appfog.com/pricing">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog/pricing/">PhpFog</a></li>
					</ul>
				</li>
				<li id="nshowcase"><a href="http://appfog.com/showcase/" title="Showcase">Showcase</a></li>
				<li id="nabout"><a href="http://appfog.com/about/" title="About">About</a></li>
				<li id="nsupport"><a href="http://appfog.com/support/" title="Support">Support</a></li>
				<li id="nblog"><a href="http://blog.appfog.com/" title="Blog">Blog</a></li>

				<li id="nlogin">
						  <a href="#" title="Log In" class="btn gray">Log In <i class="icon-chevron-down"></i></a>
						  <form id="log_in_form" class="dropdown">
							<div class="container">
							  <!-- <div class="half">
								<div class="radio_btn" id="log_in_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_php_fog" checked>
								  </span>
								  <label for="log_in_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="log_in_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_appfog">
								  </span>
								  <label for="log_in_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
							<!-- <hr> -->

							<!-- <div class="container appfog">
							  <input type="email" name="email" value="" id="appfog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="appfog_log_in_password" placeholder="Password" class="text">
							</div>
							
							<div class="container php_fog">
							  <input type="email" name="email" value="" id="php_fog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="php_fog_log_in_password" placeholder="Password" class="text">
							</div> -->
										

										
							<!-- <div class="container">  
							  <div class="half">
								<div class="checkbox">
								  <span class="active">
									<input type="checkbox" name="remember_me" value="" id="log_in_remember_me" checked>
								  </span>
								</div>
								<label for="log_in_remember_me" class="remember_me">Remember Me</label>
							  </div>

							  <div class="half forgot_password">
								<a href="#">Forgot Password?</a>
							  </div>
							</div> -->
										<a href="https://phpfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to PHP Fog</a>
										<hr>
										<a href="https://console.appfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to AppFog</a>
									</form>
								</li>
								<li id="nsignup">
									<a href="#" title="Sign Up" class="btn bright_green">Sign Up <i class="icon-chevron-down"></i></a>
									<form id="sign_up_form" class="dropdown">
							<!-- <div class="container">
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_php_fog" checked>
								  </span>
								  <label for="sign_up_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_appfog">
								  </span>
								  <label for="sign_up_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
										<!-- <hr>
													
													<div class="container php_fog">
													  <input type="email" name="email" value="" id="sign_up_php_fog_email" placeholder="Email" class="text">
													  <input type="password" name="password" value="" id="sign_up_password" placeholder="Password" class="text">
													  <input type="password" name="password_confirmation" value="" id="sign_up_password_confirmation" placeholder="Password Confirmation" class="text">
													</div>
													
													<div class="container appfog">
													  <input type="email" name="email" value="" id="sign_up_appfog_email" placeholder="Email" class="text">
													</div> -->
										
										<a href="https://phpfog.com/signup" class="btn bright_green submit" style="font-size: 13px;">Register for PHP Fog</a>
										<hr>
										<a href="http://appfog.com/signup.php" class="btn bright_green submit" style="font-size: 13px;">Register for AppFog</a>
									</form>
								</li>

			</ul>
		</div> 
	</div>
	<div id="main_content">
		<div class='container'>

			
			<div id="top_bar" class="row gray_blue margin_bottom">
				<div class="span12">
					<a href="/"><h1 class="title">PHP Fog Docs</h1></a>
					<ul id="docs_nav">
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="/best-practices">Best Practices</a></li>
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="#">Caching</a></li>
					</ul>
					<!--<ul id="secondary_nav">
						<li><a href="http://docs.appfog.com">AppFog Docs</a></li>
					</ul>-->
				</div>

			</div>
			
					


			<div id="content" class="row white">
				<div class="span8 main_content">
					<div class="row entries">
	<div class="span8">
		<div class="row">
			<div class="span8">
				<h1>Caching</h1>
				<p>PHP Fog apps can take advantage of two types of caching: Varnish and APC. Proper configuration of these two types of caching can significantly improve the performance of your app, providing a better experience for your users. </p>

<h3 id="varnish">Varnish</h3>

<p>All PHP Fog apps are fronted by Varnish, a web application accelerator that runs in front of your app server and caches content according to your HTTP Header information. Varnish can speed up delivery of your content by a factor of 300-1000, depending on your app. For more information, check out <a href="https://www.varnish-cache.org/">the Varnish site</a>. </p>

<h4 id="default-caching">Default Caching</h4>

<p>Varnish caches content automatically for 300 seconds (5 minutes). For static content, this means you don&rsquo;t you have to do anything to take advantage of Varnish.</p>

<p>There are two key exceptions, though. First, if there are cookies in the HTTP header on the request or response, the page will not be cached. Second, only responses to GET requests can be cached.</p>

<h4 id="caching-with-cookies">Caching with Cookies</h4>

<p>Requests that include cookies are not cached by default so that stale cookies don&rsquo;t impact the application behavior.</p>

<p>In a few cases cookies are used client-side only, i.e. the cookies may be produced and consumed by JavaScript but are never processed by the PHP application. For example, Google Analytics uses cookies to store information about the page. In order to try to maximize default caching, Varnish will drop these special case cookies being sent in the HTTP request to the app. If those cookies are dropped and no other cookies are present, the page can follow the default caching behavior. </p>

<p>Currently only the following cookies are dropped:</p>

<ul>
  <li>Cookies with no values (i.e. empty).</li>
  <li>Cookies from Google Analytics.</li>
  <li>Cookies with the name &ldquo;has_js&rdquo;.</li>
</ul>

<p>We can also setup a custom configuration for your application. We&rsquo;re also building tools for you to manage caching, so stay tuned!</p>

<h4 id="caching-dynamic-content">Caching Dynamic Content</h4>

<p>Caching dynamic content in Varnish can greatly improve the performance of your app. You can explicitly instruct Varnish to cache the requests and for how long.</p>

<p>The simplest way to cache a page is to set a header on output which cues Varnish that this page can be served unmodified to anyone visiting a given URL. The &ldquo;Cache-Control&rdquo; header also specifies how long the cached copy should be retained. The following is a PHP example of setting the cache to 10 minutes (600 seconds):</p>

<pre class="prettyprint"><code>header("Cache-Control: public, max-age=600");
</code></pre>

<p>Note: The longest Varnish will cache any content is 1 day. </p>

<h4 id="preventing-caching">Preventing Caching</h4>

<p>To prevent caching set the &ldquo;Cache-Control&rdquo; header to &ldquo;no-cache&rdquo;. This is generally required in applications that don&rsquo;t produce or consume cookies, but serve dynamic content. This is how to set the &ldquo;Cache-Control&rdquo; header in PHP:</p>

<pre class="prettyprint"><code>header("Cache-Control: no-cache");
</code></pre>

<h4 id="purging-cache-data">Purging Cache Data</h4>

<p>We are currently working on tools to reset the cache; however, this is not yet functional. In the mean time if you need to purge the cache, please email support@appfog.com.</p>

<h4 id="caching-in-wordpress">Caching in WordPress</h4>

<p>WordPress by default takes little advantage of caching; however, there are plugins that can improve caching by intelligently presenting the appropriate cache headers.</p>

<p>The <a href="http://wordpress.org/extend/plugins/wp-super-cache/">WP Super Cache</a> plugin and the <a href="http://wordpress.org/extend/plugins/wordpress-varnish/">WordPress Varnish</a> plugin are two plugins we recommend installing to take advantage of Varnish.</p>

<h4 id="caching-in-drupal">Caching in Drupal</h4>

<p>Drupal by default takes little advantage of caching. We recommend installing Drupal&rsquo;s <a href="http://drupal.org/project/varnish">Varnish HTTP Accelerator Integration module</a> to take advantage of Varnish on your Drupal app. </p>

<p>As another alternative we recommend <a href="http://pressflow.org/">PressFlow</a>, which is a distribution of Drupal optimized for performance. We don&rsquo;t have a Pressflow Jumpstart yet, but we&rsquo;re working on adding that soon. You can easily install PressFlow yourself by starting with a custom application.</p>

<h3 id="apc">APC</h3>

<p>The Alternative PHP Cache, or APC, is a free and open opcode cache for PHP that can significantly boost performance in your app. It&rsquo;s installed by default on all Dedicated Cloud apps.</p>

<p>Implementation of APC varies depending on your app. For example, the Cake framework has documentation <a href="http://api.cakephp.org/class/apc-engine">here</a>. Most frameworks will have similar documentation on implementation of APC.</p>

<h5 id="what-if-all-of-my-code-is-custom">What if all of my code is custom?</h5>

<p>Custom code will require a manual implementation of APC. Check out <a href="http://www.php.net/manual/en/apc.configuration.php">this link</a> for more information on how to implement APC in your app.</p>

<h5 id="pitfalls">Pitfalls</h5>

<p>The most common issue is multiple apps using the same cache to complete requests. Daniel Arroyo, CEO of Flaretag, wrote <a href="http://www.danielarroyo.net/2012/01/avoid-problems-when-running-multiple-cake-apps-in-one-server/">a great article</a> on dealing with this issue in Cake.</p>


			</div>
		</div>
	</div>
</div>

				</div>

				<div class="span3 sidebar padding accordion" id="accordion2">
					<div class="row border-bottom">
						<div class="span3">
							<form id="search-form" action="/search">
								<input type="search" placeholder="Search" id="search" name="q" size="30" />
								<input class="btn gray_blue search" type="submit" value="Go" />
							</form>
						</div>
					</div>
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne"><h6><i class="accordion-icon icon-chevron-right"></i> Getting Started</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseOne" style="height: 0;">
						
							<div class="accordion-inner">
								
								<li><a href="/getting-started/jumpstarts.html" >Jumpstarts</a></li>
								
								<li><a href="/getting-started/pf-command-line-tool.html" >PF Command Line Tool</a></li>
								
								<li><a href="/getting-started/ssh.html" >SSH</a></li>
								
								<li><a href="/getting-started/git.html" >Git</a></li>
								
								<li><a href="/getting-started/env-vars.html" >Environment Variables</a></li>
								
								<li><a href="/getting-started/development.html" >Development</a></li>
								
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
						<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo"><h6><i class="accordion-icon icon-chevron-right"></i> Customize Your App</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseTwo" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/customize/add-ons.html" >Add-ons</a></li>
							
							<li><a href="/customize/custom-domain-names.html" >Custom Domain Names</a></li>
							
							<li><a href="/customize/ssl.html" >SSL for Custom Domain Names</a></li>
							
							<li><a href="/customize/permissions.html" >Permissions</a></li>
							
							<li><a href="/customize/cron.html" >Cron Jobs</a></li>
							
							<li><a href="/customize/logs.html" >Logs</a></li>
							
							<li><a href="/customize/database.html" >Database</a></li>
							
							<li><a href="/customize/email.html" >Email</a></li>
							
							<li><a href="/customize/php_ini.html" >php.ini</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree"><h6><i class="accordion-icon icon-chevron-down"></i> Best Practices</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse in" id="collapseThree" style="height: auto;">
						
							<div class="accordion-inner">
							
							<li><a href="/best-practices/caching.html" class="on">Caching</a></li>
							
							<li><a href="/best-practices/storage.html" >Storage</a></li>
							
							<li><a href="/best-practices/scaling.html" >Scaling</a></li>
							
							</div>
						</ul>
					</div>

						<div class="row border-bottom"><div class="span3"><a href="/faqs.html" ><h6>FAQ</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="http://phpfog.com/pricing"><h6>Pricing</h6></a></div></div>
						<div class="row border-bottom"><div class="span3"><a href="/billing.html" ><h6>Billing</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/reliability.html" ><h6>Reliability</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/security.html" ><h6>Security</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/troubleshooting.html" ><h6>Troubleshooting</h6></div></a></div>

					</div>
				</div>
			</div><!-- content -->
		</div><!-- container -->
	</div><!-- main_content -->

	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="span1">
					<img src="http://appfog.com/img/bydevfordev_95.png" width="95" height="79" alt="By Developers For Developers" id="badge">
				</div>
				<div class="span3">
					<h4>About AppFog</h4>
					<p>Easily build and deploy fast, scalable, and reliable applications to the cloud in seconds. Yeah, itâ€™s that easy.</p>					
				</div>
				<div class="span2">
					<h4>Info</h4>
					<ul>
						<li><a href="http://appfog.com/support/">Support</a></li>
						<li><a href="https://appfog.com/about/">About</a></li>
						<li><a href="http://dev.appfog.com/">Documentation</a></li>
					</ul>
				</div>
				<div class="span2 offsettop">
					<ul>
						<li>Phone: 1.888.974.7364</li>
						<li>&copy; <script>document.write(new Date().getFullYear());</script> AppFog.</li>
						<li>All Rights Reserved.</li>
					</ul>
				</div>
				<div class="span4">
					<h4>Social</h4>
					<ul id="social">
						<li id="facebook"><a href="http://www.facebook.com/pages/AppFog/159333004147490">Facebook</a></li>
						<li id="twitter"><a href="https://twitter.com/#!/appfog">Twitter</a></li>
						<li id="linkedin"><a href="http://www.linkedin.com/company/appfog">LinkedIn</a></li>
					</ul>
				</div>
			</div>
		</div> <!-- / .container -->
	</div>
	
	
<!-- scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://appfog.com/js/libs/jquery-1.7.1.min.js"><\/script>')</script>
<script src="http://appfog.com/js/plugins.js"></script>
<script src="http://appfog.com/js/script.js"></script>
<script type="text/javascript" src="/js/phpfogdocs.js"></script>

</body>
</html>
