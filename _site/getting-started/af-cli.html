<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>AppFog &mdash; Documentation AF Command Line Tool</title> 

		<link rel="stylesheet" href="http://appfog.com/css/style.css">
		<link href="/css/prettify.css" type="text/css" rel="stylesheet" />
		<link href="/css/table.css" rel="stylesheet">
		<link href="/css/docs.css" rel="stylesheet">
		<!-- typekit -->
		<script type="text/javascript" src="http://use.typekit.com/abw3xjt.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
				
		<!-- css -->

		<!-- modernizr -->
		<script src="http://appfog.com/js/libs/modernizr-2.5.3.min.js"></script>

		<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
		<script type="text/javascript" src="/js/jquery.js"></script>
		<script type="text/javascript" src="/js/bootstrap.js"></script>

		<!--  -->
		<link rel="icon" type="image/png" href="http://appfog.com/favicon.ico" />
		
		<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-16856502-8']);
      _gaq.push(['_setDomainName', '.appfog.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
		
	</head>
	<body id="blog" onload="prettyPrint()">
	<div id="header">
		<div class="container">
			<a href="http://appfog.com/" id="app_fog"><img src="http://appfog.com/img/app-fog.png" width="189" height="47" alt="App Fog"></a>
			<ul id="main_nav">
				<li id="nproducts">
					<a href="#" title="Products" class="parent"><span>Products</span></a>
					<ul>
						<li><a href="http://appfog.com/products/appfog">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog">PHP Fog</a></li>
					</ul>
				</li>
				<li id="npricing">
					<a href="#" title="Pricing" class="parent"><span>Pricing</span></a>
					<ul>
						<li><a href="https://console.appfog.com/pricing">AppFog</a></li>
						<li><a href="http://appfog.com/products/phpfog/pricing/">PhpFog</a></li>
					</ul>
				</li>
				<li id="nshowcase"><a href="http://appfog.com/showcase/" title="Showcase">Showcase</a></li>
				<li id="nabout"><a href="http://appfog.com/about/" title="About">About</a></li>
				<li id="nsupport"><a href="http://appfog.com/support/" title="Support">Support</a></li>
				<li id="nblog"><a href="http://blog.appfog.com/" title="Blog">Blog</a></li>

				<li id="nlogin">
						  <a href="#" title="Log In" class="btn gray">Log In <i class="icon-chevron-down"></i></a>
						  <form id="log_in_form" class="dropdown">
							<div class="container">
							  <!-- <div class="half">
								<div class="radio_btn" id="log_in_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_php_fog" checked>
								  </span>
								  <label for="log_in_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="log_in_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="log_in_appfog">
								  </span>
								  <label for="log_in_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
							<!-- <hr> -->

							<!-- <div class="container appfog">
							  <input type="email" name="email" value="" id="appfog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="appfog_log_in_password" placeholder="Password" class="text">
							</div>
							
							<div class="container php_fog">
							  <input type="email" name="email" value="" id="php_fog_log_in_email" placeholder="Email" class="text">
							  <input type="password" name="password" value="" id="php_fog_log_in_password" placeholder="Password" class="text">
							</div> -->
										

										
							<!-- <div class="container">  
							  <div class="half">
								<div class="checkbox">
								  <span class="active">
									<input type="checkbox" name="remember_me" value="" id="log_in_remember_me" checked>
								  </span>
								</div>
								<label for="log_in_remember_me" class="remember_me">Remember Me</label>
							  </div>

							  <div class="half forgot_password">
								<a href="#">Forgot Password?</a>
							  </div>
							</div> -->
										<a href="https://phpfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to PHP Fog</a>
										<hr>
										<a href="https://console.appfog.com/login" class="btn bright_green submit" style="font-size: 13px;">Log In to AppFog</a>
									</form>
								</li>
								<li id="nsignup">
									<a href="#" title="Sign Up" class="btn bright_green">Sign Up <i class="icon-chevron-down"></i></a>
									<form id="sign_up_form" class="dropdown">
							<!-- <div class="container">
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_php_fog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_php_fog" checked>
								  </span>
								  <label for="sign_up_php_fog">Php Fog</label>
								</div>
							  </div>
							  <div class="half">
								<div class="radio_btn" id="sign_up_product_appfog">
								  <span>
									<input type="radio" name="products" value="" id="sign_up_appfog">
								  </span>
								  <label for="sign_up_appfog">AppFog</label>
								</div>
								
							  </div>
							</div> -->
										
										<!-- <hr>
													
													<div class="container php_fog">
													  <input type="email" name="email" value="" id="sign_up_php_fog_email" placeholder="Email" class="text">
													  <input type="password" name="password" value="" id="sign_up_password" placeholder="Password" class="text">
													  <input type="password" name="password_confirmation" value="" id="sign_up_password_confirmation" placeholder="Password Confirmation" class="text">
													</div>
													
													<div class="container appfog">
													  <input type="email" name="email" value="" id="sign_up_appfog_email" placeholder="Email" class="text">
													</div> -->
										
										<a href="https://phpfog.com/signup" class="btn bright_green submit" style="font-size: 13px;">Register for PHP Fog</a>
										<hr>
										<a href="http://appfog.com/signup.php" class="btn bright_green submit" style="font-size: 13px;">Register for AppFog</a>
									</form>
								</li>

			</ul>
		</div> 
	</div>
	<div id="main_content">
		<div class='container'>

			
			<div id="top_bar" class="row gray_blue margin_bottom">
				<div class="span12">
					<a href="/"><h1 class="title">AppFog Docs</h1></a>
					<ul id="docs_nav">
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="/getting-started">Getting Started</a></li>
						
						<li class="breadcrumb-separator">&raquo;</li>
						<li><a href="#">AF Command Line Tool</a></li>
					</ul>
					<ul id="secondary_nav">
						<li><a href="http://docs.phpfog.com">PHP Fog Docs</a></li>
					</ul>
				</div>

			</div>
			
					


			<div id="content" class="row white">
				<div class="span8 main_content">
					<div class="row entries">
	<div class="span8">
		<div class="row">
			<div class="span8">
				<h1>AF Command Line Tool</h1>
				<p><code>af</code> is based on CloudFoundry’s <code>vmc</code> but includes features specific to AppFog and has the default target set to AppFog’s service. Check out <a href="https://github.com/appfog/af">the GitHub repo</a>.</p>

<ul>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#usage">Usage</a></li>
  <li><a href="#getting-started">Getting Started</a></li>
  <li><a href="#apps">Apps</a></li>
  <li><a href="#app-creation">App Creation</a></li>
  <li><a href="#app-download">App Download</a></li>
  <li><a href="#app-ops">App Operations</a></li>
  <li><a href="#app-updates">App Updates</a></li>
  <li><a href="#app-info">App Information</a></li>
  <li><a href="#app-env">App Environment</a></li>
  <li><a href="#services">Services</a></li>
  <li><a href="#admin">Administration</a></li>
  <li><a href="#system">System</a></li>
  <li><a href="#misc">Misc</a></li>
  <li><a href="#help">Help</a></li>
  <li><a href="#manifests">Manifests</a></li>
</ul>

<h3 id="installation">Installation</h3>

<p>The <code>af</code> command line tool is written in Ruby and installed as a gem: </p>

<pre class="prettyprint"><code>$ gem install af
</code></pre>

<p>Note: <code>af</code> requires Ruby 1.8.7 or newer.</p>

<h3 id="usage">Usage</h3>

<pre class="prettyprint"><code>$ af [options] command [&lt;args&gt;] [command_options]
</code></pre>

<p>For more information, try:</p>

<pre class="prettyprint"><code>$ af help [command]
</code></pre>

<p>or</p>

<pre class="prettyprint"><code>$ af help options
</code></pre>

<h3 id="getting-started">Getting Started</h3>

<table class="table table-bordered table-striped">
<tr>
    <td><code>target [url]</code></td>                                <td>Reports current target or sets a new target</td>
</tr>
<tr>
    <td><code>login  [email] [--email, --passwd]</code></td>          <td>Login</td>
</tr>
<tr>
    <td><code>info</code></td>                                         <td>System and account information</td>
</tr>
</table>

<h3 id="apps">Apps</h3>

<table class="table table-bordered table-striped">
<tr>
    <td><code>apps</code></td>                                         <td>List deployed applications</td>
</tr>
</table>

<h3 id="app-creation">App Creation</h3>

<table class="table table-bordered table-striped">

<tr><td><code>push [appname]</code></td>                <td>Create, push, map, and start a new application</td></tr>
<tr><td><code>push [appname] --infra </code></td>                <td>Push application to specificed infrastructure</td></tr>
<tr><td><code>push [appname] --path</code></td>                <td>Push application from specified path</td></tr>
<tr><td><code>push [appname] --url</code></td>                <td>Set the url for the application</td></tr>
<tr><td><code>push [appname] --instances &lt;N&gt;</code></td>                <td>Set the expected number <code>&lt;N&gt;</code> of instances</td></tr>
<tr><td><code>push [appname] --mem M</code></td>                <td>Set the memory reservation for the application</td></tr>
<tr><td><code>push [appname] --no-start</code></td>                <td>Do not auto-start the application</td></tr>

</table>

<h3 id="app-download">App Download</h3>

<table class="table table-bordered table-striped">
<tr><td><code>pull &lt;appname&gt; [path]                   </code></td><td>Download last pushed source of &lt;appname&gt; to [path]</td></tr>
</table>

<h3 id="app-ops">App Operations</h3>

<table class="table table-bordered table-striped">

<tr><td><code>start &lt;appname&gt;</code>                             </td><td>Start the application</td></tr>
<tr><td><code>stop  &lt;appname&gt;</code>                              </td><td>Stop the application</td></tr>
<tr><td><code>restart &lt;appname&gt;</code>                            </td><td>Restart the application</td></tr>
<tr><td><code>delete &lt;appname&gt;</code>                             </td><td>Delete the application</td></tr>
<tr><td><code>rename &lt;appname&gt; &lt;newname&gt;</code>                   </td><td>Rename the application</td></tr>

</table>

<h3 id="app-updates">App Updates</h3>

<table class="table table-bordered table-striped">

<tr><td><code>update &lt;appname&gt; [--path]                       </code></td><td>Update the application bits</td></tr>
<tr><td><code>mem &lt;appname&gt; [memsize]                         </code></td><td>Update the memory reservation for an application</td></tr>
<tr><td><code>map &lt;appname&gt; &lt;url&gt;                          </code></td><td>Register the application to the url</td></tr>
<tr><td><code>unmap &lt;appname&gt; &lt;url&gt;                        </code></td><td>Unregister the application from the url</td></tr>
<tr><td><code>instances &lt;appname&gt; &lt;num|delta&gt;              </code></td><td>Scale the application instances up or down</td></tr>

</table>

<h3 id="app-info">App Information</h3>

<table class="table table-bordered table-striped">

<tr><td><code>crashes &lt;appname&gt;                            </code></td><td>List recent application crashes</td></tr>
<tr><td><code>crashlogs &lt;appname&gt;                          </code></td><td>Display log information for crashed applications</td></tr>
<tr><td><code>logs &lt;appname&gt; [--all]                       </code></td><td>Display log information for the application</td></tr>
<tr><td><code>files &lt;appname&gt; [path] [--all]               </code></td><td>Display directory listing or file download for path</td></tr>
<tr><td><code>stats &lt;appname&gt;                              </code></td><td>Display resource usage for the application</td></tr>
<tr><td><code>instances &lt;appname&gt;                          </code></td><td>List application instances</td></tr>

</table>

<h3 id="app-env">App Environment</h3>

<table class="table table-bordered table-striped">

<tr><td><code>env &lt;appname&gt;                                   </code></td><td>List application environment variables</td></tr>
<tr><td><code>env-add &lt;appname&gt; &lt;variable[=]value&gt;         </code></td><td>Add an environment variable to an application</td></tr>
<tr><td><code>env-del &lt;appname&gt; &lt;variable&gt;                 </code></td><td>Delete an environment variable to an application</td></tr>

</table>

<h3 id="services">Services</h3>

<table class="table table-bordered table-striped">

<tr><td><code>services                                               </code></td><td>Lists of services available and provisioned</td></tr>
<tr><td><code>create-service &lt;service&gt; [--name,--bind]            </code></td><td>Create a provisioned service</td></tr>
<tr><td><code>create-service &lt;service&gt; --infra            </code></td><td>Create a provisioned service on a specified infrastructure</td></tr>
<tr><td><code>create-service &lt;service&gt; &lt;name&gt;                  </code></td><td>Create a provisioned service and assign it &lt;name&gt;</td></tr>
<tr><td><code>create-service &lt;service&gt; &lt;name&gt; &lt;app&gt;        </code></td><td>Create a provisioned service and assign it &lt;name&gt;, and bind to &lt;app&gt;</td></tr>
<tr><td><code>delete-service [servicename]                           </code></td><td>Delete a provisioned service</td></tr>
<tr><td><code>bind-service &lt;servicename&gt; &lt;appname&gt;            </code></td><td>Bind a service to an application</td></tr>
<tr><td><code>unbind-service &lt;servicename&gt; &lt;appname&gt;          </code></td><td>Unbind service from the application</td></tr>
<tr><td><code>clone-services &lt;src-app&gt; &lt;dest-app&gt;             </code></td><td>Clone service bindings from &lt;src-app&gt; application to &lt;dest-app&gt;</td></tr>

</table>

<h3 id="admin">Administration</h3>

<table class="table table-bordered table-striped">

<tr><td><code>user                                             </code></td><td>Display user account information</td></tr>
<tr><td><code>passwd                                           </code></td><td>Change the password for the current user</td></tr>
<tr><td><code>logout                                           </code></td><td>Logs current user out of the target system</td></tr>
<tr><td><code>add-user [--email, --passwd]                     </code></td><td>Register a new user (requires admin privileges)</td></tr>
<tr><td><code>delete-user &lt;user&gt;                           </code></td><td>Delete a user and all apps and services (requires admin privileges)</td></tr>

</table>

<h3 id="system">System</h3>

<table class="table table-bordered table-striped">

<tr><td><code>runtimes                                     </code></td><td>Display the supported runtimes of the target system</td></tr>
<tr><td><code>frameworks                                   </code></td><td>Display the recognized frameworks of the target system</td></tr>
<tr><td><code>infras                                   </code></td><td>Display the available infrastructures</td></tr>

</table>

<h3 id="misc">Misc</h3>

<table class="table table-bordered table-striped">

<tr><td><code>aliases                                      </code></td><td>List aliases</td></tr>
<tr><td><code>alias &lt;alias[=]command&gt;                   </code></td><td>Create an alias for a command</td></tr>
<tr><td><code>unalias &lt;alias&gt;                           </code></td><td>Remove an alias</td></tr>
<tr><td><code>targets                                      </code></td><td>List known targets and associated authorization tokens</td></tr>

</table>

<h3 id="help">Help</h3>

<table class="table table-bordered table-striped">

<tr><td><code>help [command]                               </code></td><td>Get general help or help on a specific command</td></tr>
<tr><td><code>help options                                 </code></td><td>Get help on available options</td></tr>

</table>

<h1 id="manifests">Manifests</h1>

<p>You can use manifest documents with AppFog to simplify app deployment. These manifest documents describe apps in human-editable format. They can also describe anything from simple “Hello World” apps to complex multi-app hierarchies with inter-app dependencies and service binding information.  </p>

<p>The manifests feature uses a YAML document, aptly named <code>manifest.yml</code>. You’ll typically place this manifest document in your app’s root directory, though you can specify a different location by telling the <code>af</code> tool which to use with the <code>-m</code> flag. </p>

<p>You can create the manifest by hand, or let <code>af</code> automatically create it for you after an <code>af push</code> or with the <code>af manifest</code> command.</p>

<p>When you <code>af push</code> an app that has a manifest, <code>af</code> will simply read the input values from the file rather than prompt you for each configuration. </p>

<p>Not only can you automate <code>af push</code> with manifests, you can also bypass interactive inputs for a large portion of <code>af</code>’s commands to make using the command-line tool more efficient and user-friendly. For example, you can leave the app name out when issuing an <code>af update</code> command, and <code>af</code> will retrieve the app name from an existing manifest document.</p>

<p>Here’s the full list of commands that can take advantage of the manifest document:</p>

<ul>
  <li><code>af push</code>: Allows you to specify multiple services. Pushes with information from the manifest. If no manifest is found, it will ask if you want to create one after the interaction is finished.</li>
  <li><code>af stats</code>, <code>af update</code>, <code>af start</code>, <code>af stop</code>: If no app name is given, it operates on the app(s) described by the manifest.</li>
  <li><code>af update</code>: Syncs changes from the root of the app if a manifest is present.</li>
  <li><code>af start</code>: Starts the app in a multi-app deployment in the proper order (taking dependencies into account).</li>
  <li><code>af stop</code>: Stops multi-app deployments by shutting down each app in the reverse of the order in which they were started.</li>
  <li><code>af restart</code>: See <code>af stop</code> and <code>af start</code>.</li>
  <li><code>af delete</code>: Delete the app</li>
</ul>

<p>Note: For multi-app hierarchies, these will operate only on the sub-app you’re in, rather than always operating on every app in the hierarchy. To operate on every app, invoke the command from the root of the hierarchy.</p>

<h3 id="getting-started">Getting Started</h3>

<p>The easiest way to get going is to generate a manifest document from basic app info. If you haven’t pushed your app yet, you can start with <code>af push</code> as usual, which will ask if you want to save the configurations as a manifest document:</p>

<pre class="prettyprint"><code>$ af push
Would you like to deploy from the current directory? [Yn]:
Application Name: php-example
Detected a PHP Application, is this correct? [Yn]:
Application Deployed URL [php-example.aws.af.cm]:
Memory reservation (128M, 256M, 512M, 1G, 2G) [128M]:
How many instances? [1]:
Bind existing services to 'php-example'? [yN]:
Create services to bind to 'php-example'? [yN]: y
1: mongodb
2: mysql
3: postgresql
What kind of service?: 2
Specify the name of the service [mysql-example]:
Create another? [yN]:
Would you like to save this configuration? [yN]: y
Manifest written to manifest.yml.
Creating Application: OK
Creating Service [mysql-example]: OK
Binding Service [mysql-example]: OK
Uploading Application:
  Checking for available resources: OK
  Packing application: OK
  Uploading (1K): OK
Push Status: OK
Staging Application 'php-example': OK
Starting Application 'php-example': OK
</code></pre>

<p>As you can see, just before pushing, we saved the deployment configurations in <code>manifest.yml</code> in the same directory. Let’s take a peek at the file:</p>

<pre class="prettyprint linenums"><code>---
applications:
  .:
    name: php-example
    framework:
      name: php
      info:
        mem: 128M
        description: PHP Application
        exec: 
    url: ${name}.${target-base}
    mem: 128M
    instances: 1
    services:
      mysql-398b1:
        type: mysql
</code></pre>

<p>The manifest document has captured all of the configuration that we entered above for the app push into a description of the app deployment. Once you have a <code>manifest.yml</code> file, you can modify it however you’d like, as it’s meant to be human-editable. The structure of the document is freeform, so if you want to define arbitrary values and use them throughout your document, you can.</p>

<p>Now if we try pushing again, <code>af push</code> will use this to automate everything:</p>

<pre class="prettyprint"><code>$ af delete php-example
Provisioned service [mysql-398b1] detected, would you like to delete it? [yN]: y
Deleting application [php-example]: OK
Deleting service [mysql-398b1]: OK

$ af push
Would you like to deploy from the current directory? [Yn]:
Pushing application 'php-example'...
Creating Application: OK
Creating Service [mysql-398b1]: OK
Binding Service [mysql-398b1]: OK
Uploading Application:
  Checking for available resources: OK
  Packing application: OK
Uploading (1K): OK
Push Status: OK
Staging Application 'php-example': OK
Starting Application 'php-example': OK
</code></pre>

<p>You can also use <code>af manifest</code> to create a manifest without pushing. <code>af manifest</code> will let you create more complex manifests describing multiple applications in a single hierarchy.</p>

<p>Now that you have a manifest document, you don’t really have to do anything else if you don’t want to get fancy. It’ll passively improve <code>af</code>’s user interface experience for the commands listed above: <code>af push</code> will be interaction-free, making deployment much easier, and many other commands will be efficient to invoke.</p>

<h3 id="child-manifests">Child Manifests</h3>

<p>A manifest document can inherit properties from a parent manifest like so:</p>

<pre class="prettyprint"><code>inherit: path/to/parent.yml
</code></pre>

<p>This slurps in everything from the parent document ensuring that properties defined in the child manifest are deep-merged with the parent. The symbols are resolved after this merge has taken place, so any properties you set in the child manifest may be used in properties set in the parent.</p>

<p>This allows you to provide the basic information, such as service bindings and framework information, in a “base” manifest, which can be “filled in” via a child manifest. For example:</p>

<ul>
  <li>Having various child manifests for different deployment modes (e.g. debug, local, public) that extend base app information provided by a “base” manifest.</li>
  <li>Packaging the basic configuration along with your app, which users can extend with their own manifest to override your settings or fill in the blanks for their own deployment.</li>
</ul>

<h3 id="symbol-resolution">Symbol Resolution</h3>

<p>There are currently two special symbols:</p>

<ul>
  <li><code>target-base</code>: The base URL of your target. For example, targeting <code>api.appfog.com</code> means a <code>target-base</code> value of <code>appfog.com</code>.</li>
  <li><code>random-word</code>: A random string of characters. This is useful for making sure your URLs are unique.</li>
</ul>

<p>Otherwise, symbol resolution simulates lexical scoping, so you can define arbitrary properties, which can be overridden by child manifests or in a nested hash.</p>

<p>For example, the following parent:</p>

<pre class="prettyprint linenums"><code>applications:
  ./foo:
    name: bar
    url: ${name}.${target-base}
</code></pre>

<p>…combined with this child manifest:</p>

<pre class="prettyprint linenums"><code>applications:
  ./foo:
    name: baz
</code></pre>

<p>…and with a target of <code>api.appfog.com</code>, will result in a <code>url</code> of <code>baz.appfog.com</code> when using the child manifest, and <code>bar.appfog.com</code> when using the parent.</p>

<h3 id="multi-app-manifests">Multi-App Manifests</h3>

<p>Manifests also present a way to deploy multiple apps with a single push command. Let’s say you have a modular app comprised of several independent parts, for example, a publisher and a subscriber. You’ll want the subscriber to start before the publisher, so it doesn’t miss anything that was published. It’s best to have these two apps defined as parts of a whole, so you can specify this dependency. You can do this with multi-app manifest documents.</p>

<p>Our <code>publisher</code> app will publish messages every second, with the message starting at 0 and increasing for every iteration. The subscriber will simply collect the messages it receives in the order they came in, and display them to the user.</p>

<p>To start with, you may want to arrange your apps like so:</p>

<pre class="prettyprint"><code>./parent-app
./parent-app/publisher
./parent-app/subscriber
</code></pre>

<p>This will make using the manifest document more natural.</p>

<p>Switch to the <code>parent-app</code> directory and use <code>af manifest</code> to create your manifest document:</p>

<pre class="prettyprint"><code>$ cd parent-app
parent-app $ af manifest
Configure for which application? [.]: ./publisher
Application Name: publisher
Detected a PHP Application, is this correct? [Yn]:
Application Deployed URL [publisher.aws.af.cm]: publisher-${random-word}.${target-base}
Memory reservation (128M, 256M, 512M, 1G, 2G) [128M]:
How many instances? [1]:
Bind existing services to 'publisher'? [yN]:
Create services to bind to 'publisher'? [yN]: y
1: mongodb
2: mysql
3: postgresql
What kind of service?: 2
Specify the name of the service [mysql-example]:
Create another? [yN]:
Configure for another application? [yN]: y
Application path?: ./subscriber
Application Name: subscriber
Detected a PHP Application, is this correct? [Yn]:
Application Deployed URL [subscriber.aws.af.cm]: subscriber-${random-word}.${target-base}
Memory reservation (128M, 256M, 512M, 1G, 2G) [128M]:
How many instances? [1]:
Bind existing services to 'subscriber'? [yN]: y
1: mysql-example
Which one?: 1
Bind another? [yN]:
Create services to bind to 'subscriber'? [yN]:
Manifest written to manifest.yml.
</code></pre>

<p>In this single interactive session we’ve configured a manifest that defines two PHP apps, using a single MySQL service. We’re using URLs with a bit of randomness (provided by the special random-word symbol) to ensure uniqueness.</p>

<p>There’s one thing missing, though. We didn’t specify any dependencies between the apps. If we were to start it now, we could lose some data if the publisher starts before the subscriber:</p>

<pre class="prettyprint"><code>parent-app $ af push
Would you like to deploy from the current directory? [Yn]:
Pushing application 'publisher'...
# ...
Starting Application 'publisher': OK
Pushing application 'subscriber'...
# ...
Starting Application 'subscriber': OK

parent-app $ curl subscriber-bf872.aws.af.cm
Received: ["5", "6", "7", "8", "9"]
</code></pre>

<p>As you can see, we’ve lost some data here. In the time between the publisher starting and the subscriber starting, the subscriber has missed four messages.</p>

<p>We can fix this by editing the <code>manifest.yml</code> document to indicate that the publisher depends on the subscriber being started:</p>

<pre class="prettyprint linenums"><code>---
applications:
./publisher:
# ...
depends-on: ./subscriber
./subscriber:
# ...
</code></pre>

<p>Now let’s delete both apps and retry.</p>

<pre class="prettyprint"><code>parent-app $ af delete publisher
Deleting application [publisher]: OK

parent-app $ af delete subscriber
Deleting application [subscriber]: OK

parent-app $ af push
Would you like to deploy from the current directory? [Yn]:
Pushing application 'subscriber'...
# ...
Starting Application 'subscriber': OK
Pushing application 'publisher'...
# ...
Starting Application 'publisher': OK
</code></pre>

<p>As you can see, now the subscriber starts before the publisher, so we shouldn’t have any data loss this time.</p>

<pre class="prettyprint"><code>parent-app $ curl subscriber-bf872.aws.af.cm
Received: ["1", "2", "3", "4", "5", "6", "7"]
</code></pre>


			</div>
		</div>
	</div>
</div>

				</div>

				<div class="span3 sidebar padding accordion" id="accordion2">
					<!--
					<div class="row border-bottom">
						<div class="span3">
							<form id="search-form" action="/search">
								<input type="search" placeholder="Search" id="search" name="q" size="30" />
								<input class="btn gray_blue search" type="submit" value="Go" />
							</form>
						</div>
					</div>-->
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne"><h6><i class="accordion-icon icon-chevron-down"></i> Getting Started</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse in" id="collapseOne" style="height: auto;">
						
							<div class="accordion-inner">
								
								<li><a href="/getting-started/jumpstarts" >Jumpstarts</a></li>
								
								<li><a href="/getting-started/af-cli" class="on">AF Command Line Tool</a></li>
								
							</div>
						</ul>
					</div>
					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
						<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo"><h6><i class="accordion-icon icon-chevron-right"></i> Frameworks</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseTwo" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/frameworks/java" >Java</a></li>
							
							<li><a href="/frameworks/node" >Node</a></li>
							
							<li><a href="/frameworks/php" >PHP</a></li>
							
							<li><a href="/frameworks/python" >Python</a></li>
							
							<li><a href="/frameworks/ruby" >Ruby</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree"><h6><i class="accordion-icon icon-chevron-right"></i> Services</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseThree" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/services/overview" >Overview</a></li>
							
							<li><a href="/services/tunneling" >Tunneling</a></li>
							
							<li><a href="/services/mysql" >MySQL</a></li>
							
							<li><a href="/services/mongodb" >MongoDB</a></li>
							
							<li><a href="/services/postgresql" >PostgreSQL</a></li>
							
							</div>
						</ul>
					</div>

					<div class="accordion-group">
						<div class="row border-bottom accordion-heading">
							<div class="span3">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseFour"><h6><i class="accordion-icon icon-chevron-right"></i> Add-ons</h6></a>
							</div>
						</div>
						
						<ul class="pages accordion-body collapse" id="collapseFour" style="height: 0;">
						
							<div class="accordion-inner">
							
							<li><a href="/add-ons/searchify" >Searchify</a></li>
							
							<li><a href="/add-ons/mongolab" >MongoLab</a></li>
							
							<li><a href="/add-ons/mongohq" >MongoHQ</a></li>
							
							<li><a href="/add-ons/mailgun" >Mailgun</a></li>
							
							<li><a href="/add-ons/blitz" >Blitz</a></li>
							
							<li><a href="/add-ons/ironworker" >IronWorker</a></li>
							
							<li><a href="/add-ons/ironmq" >IronMQ</a></li>
							
							<li><a href="/add-ons/cloudmailin" >CloudMailin</a></li>
							
							<li><a href="/add-ons/cleardb" >ClearDB</a></li>
							
							<li><a href="/add-ons/partners" >Add-on Partnership</a></li>
							
							</div>
						</ul>
					</div>

						<div class="row border-bottom"><div class="span3"><a href="/faq" ><h6>FAQ</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="http://console.appfog.com/pricing"><h6>Pricing</h6></a></div></div>
						<div class="row border-bottom"><div class="span3"><a href="/billing" ><h6>BILLING</h6></div></a></div>
						<div class="row border-bottom"><div class="span3"><a href="/troubleshooting" ><h6>Troubleshooting</h6></div></a></div>
						<!--<div class="row border-bottom"><div class="span3"><a href="/architecture" ><h6>Architecture</h6></div></a></div>-->
						<div class="row border-bottom"><div class="span3"><a href="/roadmap" ><h6>Feature Roadmap</h6></div></a></div>

					</div>
				</div>
			</div><!-- content -->
		</div><!-- container -->
	</div><!-- main_content -->

	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="span1">
					<img src="http://appfog.com/img/bydevfordev_95.png" width="95" height="79" alt="By Developers For Developers" id="badge">
				</div>
				<div class="span3">
					<h4>About AppFog</h4>
					<p>Easily build and deploy fast, scalable, and reliable applications to the cloud in seconds. Yeah, it’s that easy.</p>					
				</div>
				<div class="span2">
					<h4>Info</h4>
					<ul>
						<li><a href="http://appfog.com/support/">Support</a></li>
						<li><a href="https://appfog.com/about/">About</a></li>
						<li><a href="http://dev.appfog.com/">Documentation</a></li>
					</ul>
				</div>
				<div class="span2 offsettop">
					<ul>
						<li>Phone: 1.888.974.7364</li>
						<li>&copy; <script>document.write(new Date().getFullYear());</script> AppFog.</li>
						<li>All Rights Reserved.</li>
					</ul>
				</div>
				<div class="span4">
					<h4>Social</h4>
					<ul id="social">
						<li id="facebook"><a href="http://www.facebook.com/pages/AppFog/159333004147490">Facebook</a></li>
						<li id="twitter"><a href="https://twitter.com/#!/appfog">Twitter</a></li>
						<li id="linkedin"><a href="http://www.linkedin.com/company/appfog">LinkedIn</a></li>
					</ul>
				</div>
			</div>
		</div> <!-- / .container -->
	</div>
	
	
<!-- scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://appfog.com/js/libs/jquery-1.7.1.min.js"><\/script>')</script>
<script src="http://appfog.com/js/plugins.js"></script>
<script src="http://appfog.com/js/script.js"></script>
<script type="text/javascript" src="/js/docs.js"></script>

</body>
</html>
